<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Seguridad en Mediciones - Chevron Trapial</title>
    <style>
        :root { --primary: #005aa2; --danger: #cc0000; --warning: #ffcc00; --success: #2e7d32; --dark: #1a1a1a; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 20px; line-height: 1.5; }
        .container { background: white; max-width: 850px; margin: auto; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border-top: 10px solid var(--primary); }
        .guia-planos { background: #e7f3ff; border-left: 5px solid var(--primary); padding: 15px; margin-bottom: 20px; font-size: 0.9rem; }
        .section { background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .section-h { font-weight: bold; color: var(--primary); margin-bottom: 10px; border-bottom: 2px solid #ddd; font-size: 0.9rem; text-transform: uppercase; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; }
        label { font-weight: bold; font-size: 0.8rem; display: block; margin-bottom: 5px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; font-size: 1rem; }
        button { width: 100%; padding: 18px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1.1rem; margin-top: 10px; transition: 0.3s; }
        .btn-calc { background: var(--primary); color: white; }
        .btn-email { background: #ed7d31; color: white; display: none; margin-top: 15px; }
        #result-display { margin-top: 30px; padding: 25px; border-radius: 12px; display: none; text-align: center; }
        .energy-val { font-size: 3.5rem; font-weight: bold; line-height: 1; margin: 10px 0; }
        .epp-box { text-align: left; background: white; padding: 20px; border-radius: 8px; margin-top: 15px; font-size: 0.95rem; border: 1px solid #ddd; color: #333; }
    </style>
</head>
<body>
 
<div class="container">
    <h2 style="text-align:center; color:var(--primary); margin-top:0;">Protocolo de Medici칩n Energizada (Puerta Abierta)</h2>
    
    <div class="guia-planos">
        <strong>Manual de Datos para el Operador:</strong><br>
        1. <strong>Tag Tablero:</strong> Identificaci칩n del equipo seg칰n plano.<br>
        2. <strong>I. Corto (kA):</strong> Valor "Icc" o "Isc" de la barra principal.<br>
        3. <strong>Seguridad CAT:</strong> El mult칤metro DEBE ser CAT IV para tableros de potencia.
    </div>
 
    <div class="section">
        <div class="section-h">1. Identificaci칩n y Seguridad de Instrumentos</div>
        <div class="grid">
            <div class="input-group">
                <label>Tag / Nombre del Tablero</label>
                <input type="text" id="tag_equipo" placeholder="Ej: TGD-01 / MCC-A">
            </div>
            <div class="input-group">
                <label>Instrumento de Medici칩n</label>
                <select id="cat_multimetro">
                    <option value="no">-- Seleccione Categor칤a --</option>
                    <option value="no">CAT I / II / III (PROHIBIDO)</option>
                    <option value="si">CAT IV (AUTORIZADO)</option>
                </select>
            </div>
        </div>
    </div>
 
    <div class="section">
        <div class="section-h">2. Datos de Barra y Conductor</div>
        <div class="grid">
            <div class="input-group">
                <label>I. Cortocircuito Barra (kA)</label>
                <input type="number" id="ka_barra" placeholder="Ej: 25">
            </div>
            <div class="input-group">
                <label>Longitud del Cable (m)</label>
                <input type="number" id="cable_l" value="1" step="0.1">
            </div>
            <div class="input-group">
                <label>Cables por Fase</label>
                <input type="number" id="cables_p" value="1" min="1">
            </div>
        </div>
    </div>
 
    <div class="section">
        <div class="section-h">3. Protecci칩n Aguas Arriba</div>
        <div class="grid">
            <div class="input-group" style="grid-column: span 2;">
                <label>Tipo de Dispositivo</label>
                <select id="disp" onchange="document.getElementById('time').value = this.value">
                    <option value="0.04">Fusible gG/gL (R치pido)</option>
                    <option value="0.10">Interruptor Autom치tico (Standard)</option>
                    <option value="0.02">Interruptor (Instant치neo)</option>
                </select>
            </div>
            <div class="input-group">
                <label>Tiempo t (seg)</label>
                <input type="number" id="time" value="0.04" step="0.01">
            </div>
        </div>
    </div>
 
    <button class="btn-calc" onclick="ejecutarAnalisis()">EVALUAR RIESGO DE ARCO</button>
 
    <div id="result-display">
        <div id="cat-label" style="font-size: 1.6rem; font-weight: bold; text-transform: uppercase;"></div>
        <div class="energy-val" id="e-val">0.00</div>
        <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 10px;">cal/cm</div>
        <div class="epp-box" id="epp-res"></div>
        <button class="btn-email" id="email-btn" onclick="enviarReporte()">游닎 ENVIAR REPORTE A MANTENIMIENTO</button>
    </div>
</div>
 
<script>
    let resData = {};
 
    function ejecutarAnalisis() {
        const catInstr = document.getElementById('cat_multimetro').value;
        const tag = document.getElementById('tag_equipo').value;
 
        if (catInstr === "no") {
            alert("丘멆잺 BLOQUEO: Solo se permite CAT IV para mediciones en estos tableros.");
            return;
        }
        if (!tag) return alert("Ingrese el TAG del equipo para el reporte.");
 
        const I_bar = parseFloat(document.getElementById('ka_barra').value);
        const L = parseFloat(document.getElementById('cable_l').value) || 0.1;
        const N_p = parseInt(document.getElementById('cables_p').value);
        const T = parseFloat(document.getElementById('time').value);
 
        if (!I_bar) return alert("Ingrese la corriente de barra.");
 
        // C치lculo de atenuaci칩n simplificado (50mm2 promedio)
        const R_eq = (0.000153 * L) / N_p;
        const Ibf_punto = I_bar / (1 + (I_bar * Math.sqrt(3) * R_eq / 400));
        let Ia = Ibf_punto * 0.72; 
        let energy = (0.123 * Ia * T * Math.pow(610/455, 2)) * 1.5;
        let boundary = Math.sqrt(2.142 * Ibf_punto * T);
 
        resData = { energy, boundary, ibf: Ibf_punto, t: T, tag: tag, cat: "" };
        
        const res = document.getElementById('result-display');
        res.style.display = 'block';
        document.getElementById('email-btn').style.display = 'block';
        document.getElementById('e-val').innerText = energy.toFixed(2);
 
        if (energy <= 8) {
            resData.cat = energy <= 1.2 ? "1" : "2";
            res.style.backgroundColor = energy <= 1.2 ? "#2e7d32" : "#ffcc00";
            res.style.color = energy <= 1.2 ? "#fff" : "#000";
            document.getElementById('cat-label').innerText = "AUTORIZADO - NIVEL " + resData.cat;
            document.getElementById('epp-res').innerHTML = `<b>TAG: ${tag}</b><br><b>Frontera: ${boundary.toFixed(2)}m</b><br><br>EPP: Ropa FR (${energy <= 1.2 ? '4' : '8'} cal), guantes diel칠ctricos con cuero, careta con barbilla. Instrumento CAT IV verificado.`;
        } else {
            resData.cat = energy <= 25 ? "3" : "4";
            res.style.backgroundColor = "#000"; res.style.color = "#fff";
            document.getElementById('cat-label').innerText = "游뛂 PROHIBIDO";
            document.getElementById('epp-res').innerHTML = `<b>TAG: ${tag}</b><br><b>PELIGRO:</b> Energ칤a de ${energy.toFixed(1)} cal/cm. Tarea de medici칩n a puerta abierta NO permitida. <b>DESENERGIZAR EQUIPO.</b>`;
        }
    }
 
    function enviarReporte() {
        const body = `REPORTE SEGURIDAD MEDICI칍N - TRAPIAL\nTAG EQUIPO: ${resData.tag}\n------------------\nENERG칈A: ${resData.energy.toFixed(2)} cal/cm쑆nCAT: ${resData.cat}\nFRONTERA: ${resData.boundary.toFixed(2)}m\nINSTRUMENTO: CAT IV VERIFICADO\nESTADO: ${resData.cat > 2 ? 'PROHIBIDO' : 'AUTORIZADO'}`;
        window.location.href = `mailto:mantenimientotrapialelectrico@chevron.com?subject=Arc Flash ${resData.tag} - Cat ${resData.cat}&body=${encodeURIComponent(body)}`;
    }
</script>
</body>
</html>
 
 



