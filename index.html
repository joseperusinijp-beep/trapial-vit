<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Calculador Profesional Arc Flash - Chevron Trapial</title>
    <style>
        :root { --primary: #005aa2; --danger: #cc0000; --warning: #ffcc00; --success: #2e7d32; }
        body { font-family: 'Segoe UI', sans-serif; background: #eef2f3; padding: 20px; }
        .container { background: white; max-width: 700px; margin: auto; padding: 25px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border-top: 10px solid var(--primary); }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        label { font-weight: bold; font-size: 0.85rem; display: block; margin-bottom: 5px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; background: #fff; }
        .auto-info { font-size: 0.75rem; color: #666; font-style: italic; }
        button { width: 100%; padding: 15px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1rem; margin-top: 20px; transition: 0.3s; }
        .btn-calc { background: var(--primary); color: white; }
        .btn-email { background: #ed7d31; color: white; display: none; }
        #result-display { margin-top: 25px; padding: 20px; border-radius: 10px; display: none; text-align: center; }
        .energy-num { font-size: 3rem; font-weight: bold; margin: 10px 0; }
        .alert-box { background: white; color: #333; padding: 15px; border-radius: 8px; text-align: left; margin-top: 15px; border-left: 6px solid #333; }
    </style>
</head>
<body>
 
<div class="container">
    <h1 style="text-align:center; color:var(--primary);">Seguridad El√©ctrica Chevron</h1>
    
    <div class="grid">
        <div class="input-group">
            <label>Tipo de Protecci√≥n (Normativa)</label>
            <select id="dispositivo" onchange="cargarTiempoDefault()">
                <option value="manual">-- Selecci√≥n Manual --</option>
                <option value="fuse_gg">Fusible gG/gL (Ej: Siemens 3NA)</option>
                <option value="breaker_inst">Interruptor Termomagn√©tico (Disparo Inst.)</option>
                <option value="mccb">Caja Moldeada (MCCB - Est√°ndar)</option>
                <option value="rcd">Diferencial (RCD/GFCI)</option>
                <option value="fuse_fast">Fusible Ultra R√°pido (Clase aR/gR)</option>
            </select>
        </div>
        <div class="input-group">
            <label>Corriente de Cortocircuito (kA)</label>
            <input type="number" id="ka" placeholder="Ibf en kA (Ej: 15)">
        </div>
        <div class="input-group">
            <label>Tiempo de Actuaci√≥n (seg)</label>
            <input type="number" id="time" placeholder="Ej: 0.1" step="0.001">
            <span class="auto-info" id="info-t">Puede editar el tiempo manualmente</span>
        </div>
        <div class="input-group">
            <label>Voltaje del Sistema (V)</label>
            <input type="number" id="volts" value="400">
        </div>
    </div>
 
    <button class="btn-calc" onclick="calcular()">CALCULAR RIESGO NFPA 70E</button>
 
    <div id="result-display">
        <div id="cat-label" style="font-size: 1.5rem; font-weight: bold;"></div>
        <div class="energy-num" id="e-val"></div>
        <div id="summary-data" style="margin-bottom:10px; font-weight:500;"></div>
        <div class="alert-box" id="epp-text"></div>
        <button class="btn-email" id="email-btn" onclick="enviarReporte()">üìß ENVIAR A MANTENIMIENTO CHEVRON</button>
    </div>
</div>
 
<script>
    let reportData = {};
 
    function cargarTiempoDefault() {
        const disp = document.getElementById('dispositivo').value;
        const timeField = document.getElementById('time');
        const info = document.getElementById('info-t');
        
        const tiempos = {
            "manual": "",
            "fuse_gg": 0.04,     // Tiempo promedio para falla franca
            "breaker_inst": 0.02, // Disparo instant√°neo t√≠pico
            "mccb": 0.05,       // Caja moldeada est√°ndar
            "rcd": 0.03,        // Sensibilidad est√°ndar industrial
            "fuse_fast": 0.005  // Ultra r√°pido
        };
 
        if(tiempos[disp] !== undefined) {
            timeField.value = tiempos[disp];
            info.innerText = "Tiempo sugerido por norma para " + disp;
        }
    }
 
    function calcular() {
        const I = parseFloat(document.getElementById('ka').value);
        const T = parseFloat(document.getElementById('time').value);
        const V = parseFloat(document.getElementById('volts').value);
        const D = 455; 
 
        if (!I || !T) return alert("Por favor, ingrese Corriente (kA) y Tiempo (seg).");
 
        let Ia = I * 0.72; // Reducci√≥n de corriente de arco IEEE
        let energy = (0.123 * Ia * T * (Math.pow(610/D, 2)));
        let boundary = Math.sqrt(2.142 * I * T);
 
        reportData = { energy, boundary, I, T, V, disp: document.getElementById('dispositivo').selectedOptions[0].text };
        actualizarUI(energy, boundary);
    }
 
    function actualizarUI(e, b) {
        const res = document.getElementById('result-display');
        const cat = document.getElementById('cat-label');
        const eval = document.getElementById('e-val');
        const epp = document.getElementById('epp-text');
        const btn = document.getElementById('email-btn');
        const sum = document.getElementById('summary-data');
 
        res.style.display = 'block';
        btn.style.display = 'block';
        eval.innerText = e.toFixed(2) + " cal/cm¬≤";
        sum.innerText = `Frontera de Seguridad: ${b.toFixed(2)} m | Tiempo: ${reportData.T} seg`;
 
        if (e <= 1.2) {
            setEstilo(cat, res, "NIVEL 1 - AUTORIZADO", "#2e7d32", "EPP: Camisa/Pantal√≥n FR (4 cal), careta, guantes de cuero.");
            reportData.cat = "1";
        } else if (e <= 8) {
            setEstilo(cat, res, "NIVEL 2 - PRECAUCI√ìN", "#ffcc00", "EPP: Ropa FR Nivel 2 (8 cal), careta completa + barbilla, guantes diel√©ctricos.");
            reportData.cat = "2";
            res.style.color = "#000";
        } else {
            let n = e <= 25 ? "3" : "4";
            setEstilo(cat, res, `NIVEL ${n} - ¬°PROHIBIDO TRABAJAR ENERGIZADO!`, n === "3" ? "#ed7d31" : "#000", `PELIGRO: Energ√≠a de ${e.toFixed(1)} cal/cm¬≤. Requiere desenergizar y bloqueo LOTO.`);
            reportData.cat = n;
        }
    }
 
    function setEstilo(el, box, txt, color, eppTxt) {
        el.innerText = txt;
        box.style.backgroundColor = color;
        box.style.color = (color === "#ffcc00") ? "#000" : "#fff";
        document.getElementById('epp-text').innerHTML = "<b>Requerimiento Chevron / NFPA 70E:</b><br>" + eppTxt;
    }
 
    function enviarReporte() {
        const mail = "mantenimientotrapialelectrico@chevron.com";
        const subject = `REPORTE ETIQUETA ARC FLASH - CAT ${reportData.cat} - ${reportData.I}kA`;
        const body = `REPORTE T√âCNICO ARC FLASH
--------------------------------------------------
DISPOSITIVO: ${reportData.disp}
TENSI√ìN: ${reportData.V} V
I. CORTO (Ibf): ${reportData.I} kA
TIEMPO CALCULADO: ${reportData.T} seg
--------------------------------------------------
ENERG√çA INCIDENTE: ${reportData.energy.toFixed(2)} cal/cm¬≤
CATEGOR√çA NFPA 70E: ${reportData.cat}
FRONTERA DE ARCO: ${reportData.boundary.toFixed(2)} metros
--------------------------------------------------
ESTADO: ${reportData.cat > 2 ? 'NO AUTORIZADO - DESENERGIZAR' : 'AUTORIZADO CON EPP'}
--------------------------------------------------
Generado para impresi√≥n de etiquetas de seguridad en campo.`;
 
        window.location.href = `mailto:${mail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    }
</script>
 
</body>
</html>
 


