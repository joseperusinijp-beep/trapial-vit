<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Protocolo Arc Flash - Chevron Trapial</title>
    <style>
        :root { --primary: #005aa2; --danger: #cc0000; --warning: #ffcc00; --success: #2e7d32; }
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; padding: 20px; }
        .container { background: white; max-width: 900px; margin: auto; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-top: 10px solid var(--primary); }
        .banner-jsa { background: #fff3cd; border: 1px solid #ffeeba; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center; font-weight: bold; color: #856404; }
        .section { background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .section-h { font-weight: bold; color: var(--primary); margin-bottom: 10px; border-bottom: 2px solid #ddd; font-size: 0.9rem; text-transform: uppercase; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
        label { font-weight: bold; font-size: 0.8rem; display: block; margin-bottom: 5px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        .btn-calc { width: 100%; padding: 18px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1.1rem; background: var(--primary); color: white; margin-top: 10px; }
        #result-display { margin-top: 30px; display: none; }
        
        /* Estilo Etiqueta Chevron */
        .etiqueta-af { border: 4px solid #000; width: 450px; margin: 20px auto; padding: 0; font-family: Arial, sans-serif; position: relative; }
        .etiqueta-header { background: #ffcc00; color: black; font-weight: bold; padding: 10px; font-size: 1.5rem; text-align: center; border-bottom: 4px solid #000; }
        .etiqueta-header.danger { background: #cc0000; color: white; }
        .etiqueta-body { padding: 15px; text-align: left; background: #fff; }
        .etiqueta-row { display: flex; justify-content: space-between; border-bottom: 1px solid #ccc; padding: 5px 0; }
        
        .loto-box { background: #f8d7da; color: #721c24; padding: 15px; border-radius: 8px; border: 1px solid #f5c6cb; margin-top: 15px; font-weight: bold; }
    </style>
</head>
<body>
 
<div class="container">
    <div class="banner-jsa">
        ‚ö†Ô∏è ANTES DE INICIAR: Debe haber le√≠do el JSA, completado el Paquete de Trabajo, Permisos y VIT.
    </div>
 
    <h2 style="text-align:center; color:var(--primary);">Gesti√≥n de Arco El√©ctrico - SET NOC SUR</h2>
 
    <div class="section">
        <div class="section-h">1. Selecci√≥n de Equipo (Datos Estudio Abril 2024)</div>
        <div class="grid">
            <div class="input-group">
                <label>Seleccione Tablero</label>
                <select id="tablero_select" onchange="cargarDatosEstudio()">
                    <option value="">-- Seleccionar de la lista --</option>
                    <option value="playa1">TAB SECC PLAYA N¬∞1 SET NOC</option>
                    <option value="ssaa">TAB SERV AUX CA-CC SET NOC</option>
                    <option value="shelter">TAB SECC SHELTER SET NOC</option>
                    <option value="cargador">TAB CARG BAT 110VCC SET NOC</option>
                    <option value="refrig1">TAB REFRIG T1 SET NOC</option>
                    <option value="refrig2">TAB REFRIG T2 SET NOC</option>
                    <option value="manual">OTRO (Carga Manual)</option>
                </select>
            </div>
            <div class="input-group">
                <label>Tipo de Tarea a Realizar</label>
                <select id="tipo_tarea" onchange="toggleTarea()">
                    <option value="medicion">Medici√≥n o Inspecci√≥n Visual</option>
                    <option value="intervencion">Cambio de componentes / Reparaci√≥n</option>
                </select>
            </div>
        </div>
    </div>
 
    <div id="datos_tecnicos" class="section">
        <div class="section-h">2. Datos T√©cnicos del Punto</div>
        <div class="grid">
            <div class="input-group">
                <label>Energ√≠a Incidente (cal/cm¬≤)</label>
                <input type="number" id="e_inc" step="0.01">
            </div>
            <div class="input-group">
                <label>Frontera de Arco (m)</label>
                <input type="number" id="boundary" step="0.01">
            </div>
            <div class="input-group">
                <label>Categor√≠a EPP</label>
                <input type="text" id="cat_epp" readonly>
            </div>
        </div>
    </div>
 
    <div id="loto_warning" class="loto-box" style="display:none;">
        üö® ATENCI√ìN: Para trabajos de intervenci√≥n, debe aplicar las 5 REGLAS DE ORO y realizar bloqueo LOTO de la instalaci√≥n antes de comenzar.
    </div>
 
    <button class="btn-calc" onclick="generarProtocolo()">GENERAR ETIQUETA Y REPORTE</button>
 
    <div id="result-display">
        <div class="etiqueta-af" id="etiqueta_visual">
            <div class="etiqueta-header" id="et_head">ADVERTENCIA</div>
            <div class="etiqueta-body">
                <div style="font-weight: bold; text-align: center; margin-bottom: 10px;">PELIGRO DE ARCO EL√âCTRICO Y DESCARGA</div>
                <div class="etiqueta-row"><span>Energ√≠a Incidente:</span> <span id="et_ene"></span></div>
                <div class="etiqueta-row"><span>Frontera de Arco:</span> <span id="et_dist"></span></div>
                <div class="etiqueta-row"><span>Nivel de EPP:</span> <span id="et_cat"></span></div>
                <div class="etiqueta-row"><span>Equipo (TAG):</span> <span id="et_tag"></span></div>
                <div style="font-size: 0.7rem; margin-top: 10px; text-align: center;">Basado en Estudio 25110.0-E4-MC-501-05</div>
            </div>
        </div>
        <button style="background:#ed7d31; color:white;" class="btn-calc" onclick="enviarMantenimiento()">üìß ENVIAR ETIQUETA A MANTENIMIENTO</button>
    </div>
</div>
 
<script>
    const estudio = {
        "playa1": { e: 0.28, b: 0.35, cat: "CATEGORIA 1", tag: "TAB SECC PLAYA N¬∞1" },
        "ssaa": { e: 0.54, b: 0.48, cat: "CATEGORIA 1", tag: "TAB SERV AUX CA-CC" },
        "shelter": { e: 0.15, b: 0.25, cat: "CATEGORIA 1", tag: "TAB SECC SHELTER" },
        "cargador": { e: 0.10, b: 0.20, cat: "CATEGORIA 1", tag: "TAB CARG BAT 110VCC" },
        "refrig1": { e: 0.32, b: 0.38, cat: "CATEGORIA 1", tag: "TAB REFRIG T1" },
        "refrig2": { e: 0.32, b: 0.38, cat: "CATEGORIA 1", tag: "TAB REFRIG T2" }
    };
 
    function cargarDatosEstudio() {
        const val = document.getElementById('tablero_select').value;
        if(estudio[val]) {
            document.getElementById('e_inc').value = estudio[val].e;
            document.getElementById('boundary').value = estudio[val].b;
            document.getElementById('cat_epp').value = estudio[val].cat;
        }
    }
 
    function toggleTarea() {
        const tarea = document.getElementById('tipo_tarea').value;
        document.getElementById('loto_warning').style.display = (tarea === 'intervencion') ? 'block' : 'none';
    }
 
    function generarProtocolo() {
        const e = parseFloat(document.getElementById('e_inc').value);
        const b = document.getElementById('boundary').value;
        const tag = document.getElementById('tablero_select').selectedOptions[0].text;
        
        if(!e) return alert("Cargue los datos t√©cnicos.");
 
        document.getElementById('result-display').style.display = 'block';
        document.getElementById('et_ene').innerText = e + " cal/cm¬≤";
        document.getElementById('et_dist').innerText = b + " m";
        document.getElementById('et_tag').innerText = tag;
        
        const catNum = e <= 1.2 ? "CATEGORIA 1" : (e <= 8 ? "CATEGORIA 2" : "CATEGORIA 3/4");
        document.getElementById('et_cat').innerText = catNum;
        document.getElementById('cat_epp').value = catNum;
 
        if (e > 8) {
            document.getElementById('et_head').innerText = "PELIGRO";
            document.getElementById('et_head').className = "etiqueta-header danger";
        } else {
            document.getElementById('et_head').innerText = "ADVERTENCIA";
            document.getElementById('et_head').className = "etiqueta-header";
        }
    }
 
    function enviarMantenimiento() {
        const tag = document.getElementById('tablero_select').selectedOptions[0].text;
        const e = document.getElementById('e_inc').value;
        const cat = document.getElementById('cat_epp').value;
        const tarea = document.getElementById('tipo_tarea').selectedOptions[0].text;
 
        const body = `REPORTE DE RIESGO DE ARCO EL√âCTRICO - CHEVRON\n` +
                     `EQUIPO: ${tag}\n` +
                     `TAREA: ${tarea}\n` +
                     `--------------------------------------------------\n` +
                     `RESULTADOS DEL ESTUDIO:\n` +
                     `- Energ√≠a Incidente: ${e} cal/cm¬≤\n` +
                     `- Nivel de EPP Requerido: ${cat}\n` +
                     `--------------------------------------------------\n` +
                     `PROTOCOLOS VERIFICADOS:\n` +
                     `[X] JSA Le√≠do y firmado\n` +
                     `[X] VIT y Permiso de trabajo completados\n` +
                     `${tarea.includes('Cambio') ? '[X] APLICADAS 5 REGLAS DE ORO / LOTO' : '[X] MEDICI√ìN PUERTA ABIERTA'}\n\n` +
                     `Favor archivar para actualizaci√≥n de etiquetas en campo.`;
 
        window.location.href = `mailto:mantenimientotrapialelectrico@chevron.com?subject=Etiqueta Arc Flash - ${tag}&body=${encodeURIComponent(body)}`;
    }
</script>
</body>
</html>
 




